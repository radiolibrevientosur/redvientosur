import{r,s as f,a as j,j as e,q as w,S as N}from"./index-BrRfBUNT.js";import{E as C}from"./EventoCulturalCard-DpdPM89x.js";import{C as k}from"./Cumplea単osCard-CL42PL_t.js";import{C as E,a as D}from"./clock-CEqe0kCk.js";import{f as S}from"./format-6SnhDrvL.js";import"./postStore-CI7NDm86.js";import"./endOfMonth-CHJGNAHY.js";import"./en-US-D3c9jfE3.js";import"./share-2-2ppTR6CC.js";import"./send-C65sD64D.js";import"./es-B8gmi2Zg.js";import"./cake-B0RVjk0u.js";const _=[{id:"pendiente",title:"Pendientes",color:"bg-yellow-100"},{id:"en_progreso",title:"En Progreso",color:"bg-blue-100"},{id:"completada",title:"Completadas",color:"bg-green-100"}],M=()=>{const[c,d]=r.useState([]),[m,p]=r.useState(!0);r.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:t,error:a}=await f.from("tareas").select("*").order("fecha_limite",{ascending:!0});if(a)throw a;d(t||[])}catch(t){console.error("Error al cargar tareas:",t),j.error("Error al cargar las tareas")}finally{p(!1)}},h=(t,a)=>{t.dataTransfer.setData("taskId",a)},b=async(t,a)=>{t.preventDefault();const l=t.dataTransfer.getData("taskId");try{const{error:o}=await f.from("tareas").update({estado:a}).eq("id",l);if(o)throw o;d(c.map(n=>n.id===l?{...n,estado:a}:n)),j.success("Tarea actualizada")}catch(o){console.error("Error al actualizar tarea:",o),j.error("Error al actualizar la tarea")}},u=t=>{t.preventDefault()};return m?e.jsx("div",{children:"Cargando tareas..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:_.map(t=>e.jsxs("div",{className:`${t.color} dark:bg-gray-800 p-4 rounded-lg shadow`,onDrop:a=>b(a,t.id),onDragOver:u,children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t.title}),e.jsx("div",{className:"space-y-4",children:c.filter(a=>a.estado===t.id).map(a=>{var l;return e.jsxs("div",{draggable:!0,onDragStart:o=>h(o,a.id),className:"bg-white dark:bg-gray-700 p-4 rounded shadow-sm cursor-move hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:a.titulo})}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-300 mt-1",children:a.descripcion}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:a.asignado_a})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:new Date(a.fecha_limite).toLocaleDateString()})]})]}),((l=a.checklist)==null?void 0:l.length)>0&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[a.checklist.filter(o=>o.completado).length," / ",a.checklist.length]})]})})]},a.id)})})]},t.id))})},U=()=>{const[c,d]=r.useState([]),[m,p]=r.useState([]),[y,h]=r.useState(!0),[b,u]=r.useState(!0),[t,a]=r.useState(""),[l,o]=r.useState("");r.useEffect(()=>{(async()=>{h(!0);const{data:i,error:x}=await f.from("eventos").select("*").order("fecha_inicio",{ascending:!0});d(i||[]),h(!1)})()},[]),r.useEffect(()=>{(async()=>{u(!0);const i=new Date,x=i.getMonth()+1,g=i.getDate(),{data:v}=await f.from("cumpleanos").select("*").filter("extract(month from fecha_nacimiento)","eq",x).filter("extract(day from fecha_nacimiento)","eq",g);p(v||[]),u(!1)})()},[]);const n=c.filter(s=>{var g;const i=(g=s.titulo)==null?void 0:g.toLowerCase().includes(t.toLowerCase()),x=l?S(new Date(s.fecha_inicio),"yyyy-MM-dd")===l:!0;return i&&x});return e.jsxs("main",{className:"p-4 max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Agenda"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 items-center justify-between",children:[e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-1/2",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:e.jsx(N,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",placeholder:"Buscar evento...",value:t,onChange:s=>a(s.target.value),className:"pl-10 pr-3 py-2 rounded-full border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 w-full transition shadow-sm","aria-label":"Buscar evento"})]}),e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx("input",{type:"date",value:l,onChange:s=>o(s.target.value),className:"px-3 py-2 rounded-full border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 w-full transition shadow-sm","aria-label":"Filtrar por fecha"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeWidth:"2",d:"M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2Z"})})})]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("button",{onClick:()=>window.location.href="/calendar",className:"inline-flex items-center gap-2 px-5 py-2 rounded-full bg-primary-600 text-white font-semibold shadow hover:bg-primary-700 transition focus:outline-none focus:ring-2 focus:ring-primary-500","aria-label":"Programar evento",children:[e.jsx("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeWidth:"2",d:"M12 5v14m7-7H5"})}),"Programar"]})})]}),e.jsxs("section",{"aria-labelledby":"eventos-culturales",className:"mb-8",children:[e.jsx("h2",{id:"eventos-culturales",className:"text-xl font-semibold mb-4",children:"Eventos culturales"}),y?e.jsx("div",{children:"Cargando eventos..."}):n.length===0?e.jsx("div",{children:"No hay eventos culturales."}):n.map(s=>e.jsx(C,{event:s},s.id))]}),e.jsxs("section",{"aria-labelledby":"cumpleanos",className:"mb-8",children:[e.jsx("h2",{id:"cumpleanos",className:"text-xl font-semibold mb-4",children:"Cumplea単os"}),b?e.jsx("div",{children:"Cargando cumplea単os..."}):m.length===0?e.jsx("div",{children:"No hay cumplea単os hoy."}):m.map(s=>e.jsx(k,{birthday:s},s.id))]}),e.jsxs("section",{"aria-labelledby":"tareas",className:"mb-8",children:[e.jsx("h2",{id:"tareas",className:"text-xl font-semibold mb-4",children:"Tareas"}),e.jsx(M,{})]})]})};export{U as default};
