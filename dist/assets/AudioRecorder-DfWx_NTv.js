import{c as v,r as e,j as s,s as M,d as H}from"./index-BGdIQiaM.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],F=v("file-text",L);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],T=v("mic",B);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],V=v("music",D),z=e.forwardRef(({onAudioReady:p,folder:N="media"},U)=>{const[r,f]=e.useState(!1),[q,o]=e.useState(null),[S,g]=e.useState(0),[h,l]=e.useState(!1),[P,i]=e.useState(0),[x,u]=e.useState(null);e.useState(!1);const[m,w]=e.useState(!1),t=e.useRef(null),b=e.useRef([]),d=e.useRef(null),_=async()=>{o(null),g(0),i(0),l(!1),u(null),window.navigator.vibrate&&window.navigator.vibrate([50,30,50]);const n=await navigator.mediaDevices.getUserMedia({audio:!0}),c=new window.MediaRecorder(n);t.current=c,b.current=[],c.ondataavailable=a=>{b.current.push(a.data)},c.onstop=async()=>{const a=new Blob(b.current,{type:"audio/webm"});u(a),o(URL.createObjectURL(a)),k()},c.start(),f(!0),d.current=setInterval(()=>g(a=>a+1),1e3)},R=()=>{t.current&&r&&(f(!1),d.current&&clearInterval(d.current),t.current.onstop=()=>{const n=new Blob(b.current,{type:"audio/webm"});u(n),o(URL.createObjectURL(n)),k()},t.current.stop())},k=async()=>{if(x){l(!0),i(0);try{const n=`${N}/audio_${Date.now()}_${Math.random().toString(36).substring(2,8)}.webm`;for(let y=1;y<=90;y+=10)await new Promise($=>setTimeout($,60)),i(y);const{error:c}=await M.storage.from("media").upload(n,x);if(i(100),l(!1),c)throw c;const{data:a}=M.storage.from("media").getPublicUrl(n);o(null),u(null),p(a.publicUrl)}catch{l(!1),i(0),o(null),u(null),p(null),H.error("Error al subir audio")}}},j=()=>{f(!1),o(null),g(0),i(0),l(!1),p(null),d.current&&clearInterval(d.current),t.current&&t.current.state!=="inactive"&&t.current.stop()},I=()=>{t.current&&r&&!m&&(t.current.pause(),w(!0))},C=()=>{t.current&&r&&m&&(t.current.resume(),w(!1))};return e.useImperativeHandle(U,()=>({startRecording:_,stopRecording:R,cancelRecording:j,isRecording:()=>r,isUploading:()=>h})),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2 items-center",children:[r&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:R,className:"btn btn-danger btn-sm animate-pulse",children:"Detener"}),s.jsx("button",{type:"button",onClick:I,disabled:m,className:"btn btn-warning btn-xs ml-2",children:"Pausar"}),s.jsx("button",{type:"button",onClick:C,disabled:!m,className:"btn btn-success btn-xs ml-2",children:"Reanudar"})]}),r&&s.jsxs("span",{className:"text-red-500 font-mono animate-pulse",children:[S,"s"]}),(r||h)&&s.jsx("button",{type:"button",onClick:j,className:"btn btn-secondary btn-sm",children:"Cancelar"})]}),h&&s.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:s.jsx("div",{className:"bg-primary-500 h-2 rounded",style:{width:`${P}%`}})})]})});export{z as A,F,T as M,V as a};
