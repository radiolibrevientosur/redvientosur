import{c as p,r as t,b as _,j as e,L as S,m as x,h as l,C as I,s as n,a as h}from"./index-DZQ_1XEG.js";import{S as L}from"./share-2-DXdZN_52.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=p("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=p("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),D=[{label:"Para ti",value:"feed"},{label:"Lo √∫ltimo",value:"timeline"}],q=()=>{const[g,u]=t.useState([]),[f,c]=t.useState(!0),[i,y]=t.useState("Todos");t.useState(null),t.useState({}),t.useState(null),_(),t.useState(""),t.useState(!1);const[d,b]=t.useState("feed");t.useEffect(()=>{(async()=>{c(!0);const{data:s,error:w}=await n.from("publicaciones").select("id, titulo, excerpt, imagen_portada, categoria, publicado_en, autor_id").eq("tipo","blog").order("publicado_en",{ascending:!1});if(w){u([]),c(!1),h.error("Error al cargar los blogs");return}const N=await Promise.all((s||[]).map(async r=>{let o={nombre_completo:"Autor",avatar_url:"/default-avatar.png",id:"",nombre_usuario:""};if(r.autor_id){const{data:m}=await n.from("usuarios").select("id, nombre_completo, avatar_url, nombre_usuario").eq("id",r.autor_id).single();m&&(o=m)}const{count:k}=await n.from("comentarios_blog").select("*",{count:"exact",head:!0}).eq("publicacion_id",r.id),{count:C}=await n.from("reacciones_blog").select("*",{count:"exact",head:!0}).eq("publicacion_id",r.id).eq("tipo","like");return{id:r.id,title:r.titulo,excerpt:r.excerpt,coverImage:r.imagen_portada,authorId:o.id,authorUsername:o.nombre_usuario,authorName:o.nombre_completo,authorAvatar:o.avatar_url,published:r.publicado_en,category:r.categoria||"General",commentsCount:k||0,likesCount:C||0}}));u(N),c(!1)})()},[]);const v=["Todos","Arte","M√∫sica","Cine","Danza","Literatura"],j=a=>{const s=window.location.origin+"/blogs/"+a.id;navigator.share?navigator.share({title:a.title,text:a.excerpt,url:s}).catch(()=>{}):(navigator.clipboard.writeText(s),h.success("¬°Enlace copiado!"))};return f?e.jsx("div",{className:"py-8 flex justify-center",children:e.jsx(S,{message:"Cargando art√≠culos..."})}):e.jsxs("div",{className:"space-y-6 min-h-screen bg-gradient-to-b from-primary-50 via-white to-gray-100 dark:from-gray-900 dark:via-gray-950 dark:to-gray-900",role:"main","aria-label":"Listado de blogs",children:[e.jsxs("header",{className:"py-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-primary-700 dark:text-primary-300 drop-shadow-sm mb-2",children:"Blogs culturales"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:"Descubre art√≠culos, historias y novedades de la comunidad"})]}),e.jsx("div",{className:"flex justify-center gap-4 my-4",children:D.map(a=>e.jsx("button",{className:`px-5 py-2 rounded-full font-semibold transition-colors duration-150 focus:outline-none focus:ring-2 focus:ring-primary-500 text-base ${d===a.value?"bg-primary-600 text-white shadow-md":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,onClick:()=>b(a.value),"aria-pressed":d===a.value,tabIndex:0,children:a.label},a.value))}),e.jsx("nav",{className:"flex overflow-x-auto pb-2 hide-scrollbar","aria-label":"Categor√≠as de blogs",children:e.jsx("div",{className:"flex space-x-2",children:v.map(a=>e.jsx(x.button,{onClick:()=>y(a),className:`px-4 py-2 rounded-full text-sm whitespace-nowrap focus:outline-none focus:ring-2 focus:ring-primary-500 ${i===a?"bg-primary-600 text-white shadow":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300"}`,whileTap:{scale:.95},"aria-pressed":i===a,tabIndex:0,children:a},a))})}),e.jsx("div",{className:"space-y-8",children:g.filter(a=>i==="Todos"||a.category===i).slice().sort((a,s)=>d==="feed"?(s.likesCount||0)-(a.likesCount||0):new Date(s.published).getTime()-new Date(a.published).getTime()).map(a=>e.jsx("article",{className:"card p-0 overflow-hidden shadow-lg hover:shadow-2xl transition-shadow duration-200 bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 group",tabIndex:0,"aria-label":`Blog: ${a.title}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"md:w-1/3 aspect-video md:aspect-square",children:e.jsx("img",{src:a.coverImage,alt:a.title,className:"w-full h-full object-cover rounded-none md:rounded-l-lg border-0 group-hover:scale-105 transition-transform duration-200"})}),e.jsxs("div",{className:"p-6 md:w-2/3 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mb-2",children:[e.jsx("span",{className:"bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 px-2 py-0.5 rounded-full",children:a.category}),e.jsx("span",{className:"mx-2",children:"‚Ä¢"}),e.jsxs(l,{to:`/blogs/${a.id}`,className:"flex items-center group hover:underline",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:new Date(a.published).toLocaleDateString("es-ES")})]})]}),e.jsx("h3",{className:"text-2xl font-bold mb-1 text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors duration-200",children:a.title}),e.jsx("p",{className:"text-base text-gray-600 dark:text-gray-300 mb-3 line-clamp-3",children:a.excerpt})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs(l,{to:a.authorUsername?`/profile/${a.authorUsername}`:"#",className:"flex items-center group focus:outline-none focus:ring-2 focus:ring-primary-500","aria-label":`Ver perfil de ${a.authorName}`,children:[e.jsx("div",{className:"avatar h-8 w-8 mr-2",children:e.jsx("img",{src:a.authorAvatar,alt:a.authorName,className:"avatar-img rounded-full border border-gray-300 dark:border-gray-700"})}),e.jsx("span",{className:"text-sm font-medium group-hover:underline",children:a.authorName})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 gap-4",children:[e.jsxs("span",{className:"flex items-center","aria-label":"Comentarios",children:["üí¨ ",a.commentsCount||0]}),e.jsxs("span",{className:"flex items-center","aria-label":"Me gusta",children:["‚ù§Ô∏è ",a.likesCount||0]}),e.jsx("button",{onClick:()=>j(a),className:"ml-2 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500",title:"Compartir blog","aria-label":"Compartir blog",tabIndex:0,children:e.jsx(L,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})]}),e.jsx("div",{className:"flex items-center gap-4 mt-4",children:e.jsxs(l,{to:`/blogs/${a.id}`,className:"btn btn-primary px-4 py-2 rounded-full text-white font-semibold shadow hover:scale-105 transition-transform duration-150",tabIndex:0,children:["Leer art√≠culo ",e.jsx(A,{className:"inline ml-2 h-4 w-4"})]})})]})]})},a.id))}),e.jsx("div",{className:"fixed bottom-20 right-4 z-40",children:e.jsx(l,{to:"/blogs/new",children:e.jsx(x.button,{className:"btn btn-primary rounded-full p-4 shadow-lg text-lg focus:outline-none focus:ring-2 focus:ring-primary-500",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Crear nuevo blog",tabIndex:0,children:e.jsx(B,{className:"h-6 w-6"})})})})]})};export{q as default};
