import{c as E,t as m,f as C,g as D,h as O,r as h,a as j,i as T,j as e,C as S,k as b,l as F,L}from"./index-BGdIQiaM.js";import{c as _,e as I}from"./endOfMonth-Dpn14GlW.js";import{C as $,a as B}from"./chevron-right-Dpb_Fcqd.js";import{C as H,S as R}from"./square-check-big-BopAoBeb.js";import{a as Y,C as z}from"./CreateBirthdayForm-CH1FtH1L.js";import{C as W}from"./CreateEventForm-DBBxU2Rv.js";import{C as q}from"./CreateTaskForm-DIOjztFl.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],A=E("map-pin",P);function M(t,r){const s=m(t);if(isNaN(r))return C(t,NaN);if(!r)return s;const a=s.getDate(),n=C(t,s.getTime());n.setMonth(s.getMonth()+r+1,0);const l=n.getDate();return a>=l?n:(s.setFullYear(n.getFullYear(),n.getMonth(),a),s)}function k(t,r){const s=D(t),a=D(r);return+s==+a}function Q(t,r){const s=m(t.start),a=m(t.end);let n=+s>+a;const l=n?+s:+a,i=n?a:s;i.setHours(0,0,0,0);let o=1;const d=[];for(;+i<=l;)d.push(m(i)),i.setDate(i.getDate()+o),i.setHours(0,0,0,0);return n?d.reverse():d}function V(t){const r=m(t);return r.setDate(1),r.setHours(0,0,0,0),r}function G(t,r){var o,d;const s=O(),a=s.weekStartsOn??((d=(o=s.locale)==null?void 0:o.options)==null?void 0:d.weekStartsOn)??0,n=m(t),l=n.getDay(),i=(l<a?-7:0)+6-(l-a);return n.setDate(n.getDate()+i),n.setHours(23,59,59,999),n}function J(t,r){const s=m(t),a=m(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}function K(t){return k(t,_(t))}function U(t,r){return M(t,-r)}const X=(t,r)=>t.filter(s=>{const a=new Date(s.date);return k(a,r)}),Z=t=>{switch(t){case"event":return"bg-primary-500";case"task":return"bg-yellow-500";case"birthday":return"bg-pink-500";default:return"bg-gray-500"}},ee=({onSelectDate:t,selectedDate:r})=>{const[s,a]=h.useState(new Date),{events:n}=j(),l=V(s),i=I(l),o=T(l),d=G(i),y=Q({start:o,end:d}),f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=()=>{a(c=>U(c,1))},g=()=>{a(c=>M(c,1))};return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-5 w-5 text-primary-600 dark:text-primary-400 mr-2"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:b(s,"MMMM yyyy")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:p,className:"p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:e.jsx($,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),e.jsx("button",{onClick:g,className:"p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:e.jsx(B,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})})]})]}),e.jsx("div",{className:"grid grid-cols-7 mb-1 text-center",children:f.map(c=>e.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 py-1",children:c},c))}),e.jsx("div",{className:"grid grid-cols-7 gap-px bg-gray-200 dark:bg-gray-700 rounded overflow-hidden",children:y.map(c=>{const x=X(n,c),u=J(c,s),v=k(c,r),N=K(c);return e.jsxs("button",{onClick:()=>t(c),className:`
                h-16 sm:h-20 p-1 flex flex-col relative 
                ${u?"bg-white dark:bg-gray-900":"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-600"}
                ${v?"ring-2 ring-primary-500 z-10":""}
                ${N&&!v?"ring-1 ring-primary-300 dark:ring-primary-700":""}
              `,children:[e.jsx("span",{className:`
                  text-xs leading-none w-5 h-5 flex items-center justify-center rounded-full 
                  ${N?"bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300 font-medium":""}
                `,children:b(c,"d")}),x.length>0&&e.jsxs("div",{className:"mt-auto",children:[x.slice(0,3).map((w,ne)=>e.jsx("div",{className:`h-1.5 rounded-full my-0.5 ${Z(w.type)}`},w.id)),x.length>3&&e.jsxs("span",{className:"text-xs text-right block text-gray-500 dark:text-gray-400",children:["+",x.length-3]})]})]},c.toString())})})]})},te=t=>{switch(t){case"event":return e.jsx(S,{className:"h-4 w-4 text-primary-500"});case"task":return e.jsx(R,{className:"h-4 w-4 text-yellow-500"});case"birthday":return e.jsx(Y,{className:"h-4 w-4 text-pink-500"})}},se=t=>{switch(t){case"event":return"Event";case"task":return"Task";case"birthday":return"Birthday"}},ae=({date:t,onCreateEvent:r})=>{const{events:s,getEventsByDate:a}=j(),n=a(t);return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:b(t,"EEEE, MMMM d")}),e.jsx("button",{onClick:r,className:"btn btn-primary px-3 py-1 text-xs rounded-full",children:"+ Add"})]}),n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No events for this day"}),e.jsx("button",{onClick:r,className:"mt-3 btn btn-ghost text-primary-600 dark:text-primary-400",children:"Create an event"})]}):e.jsx("div",{className:"space-y-3",children:n.map(l=>e.jsx(re,{event:l},l.id))})]})},re=({event:t})=>e.jsx("div",{className:"card hover:bg-gray-50 dark:hover:bg-gray-800/60 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:te(t.type)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t.title}),e.jsx("span",{className:"inline-block text-xs px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 mt-1",children:se(t.type)})]})}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:t.description}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-y-1 gap-x-3",children:[t.time&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(H,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:F(t.time)})]}),t.location&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(A,{className:"h-3 w-3 mr-1"}),e.jsx("span",{children:t.location})]})]})]})]})}),he=()=>{const[t,r]=h.useState(new Date),[s,a]=h.useState(!1),[n,l]=h.useState(null),[i,o]=h.useState(!1),{isLoading:d,fetchEvents:y}=j();h.useEffect(()=>{y()},[y]);const f=u=>{r(u),o(!0)},p=()=>{o(!0)},g=u=>{l(u),a(!0),o(!1)},c=()=>{a(!1),l(null)},x=()=>{a(!1),l(null)};return d?e.jsx("div",{className:"py-8 flex justify-center",children:e.jsx(L,{message:"Loading calendar..."})}):e.jsx("div",{className:"space-y-4 min-h-screen bg-gradient-to-b from-primary-50 via-white to-gray-100 dark:from-gray-900 dark:via-gray-950 dark:to-gray-900 p-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-primary-700 dark:text-primary-300 drop-shadow-sm mb-6 text-center",children:"Calendario cultural"}),e.jsx(ee,{selectedDate:t,onSelectDate:f}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-8 w-full max-w-xs flex flex-col items-center gap-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"¿Qué deseas crear?"}),e.jsx("button",{onClick:()=>g("event"),className:"w-full py-2 rounded-full bg-primary-600 text-white font-semibold shadow hover:bg-primary-700 transition mb-2",children:"Evento"}),e.jsx("button",{onClick:()=>g("birthday"),className:"w-full py-2 rounded-full bg-pink-500 text-white font-semibold shadow hover:bg-pink-600 transition mb-2",children:"Cumpleaños"}),e.jsx("button",{onClick:()=>g("task"),className:"w-full py-2 rounded-full bg-yellow-500 text-white font-semibold shadow hover:bg-yellow-600 transition",children:"Tarea"}),e.jsx("button",{onClick:()=>o(!1),className:"mt-2 text-gray-500 hover:underline",children:"Cancelar"})]})}),s?n==="event"?e.jsx(W,{date:t,onSuccess:c,onCancel:x}):n==="birthday"?e.jsx(z,{onSuccess:c,onCancel:x,initialData:{fecha_nacimiento:t.toISOString().slice(0,10)}}):n==="task"?e.jsx(q,{onSuccess:c,onCancel:x}):null:e.jsx(ae,{date:t,onCreateEvent:p})]})})};export{he as default};
