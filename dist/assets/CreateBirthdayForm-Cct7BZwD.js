import{c as E,j as e,r as o,R as z,s as m,a as v}from"./index-DZQ_1XEG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=E("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h0.01",key:"hsw7lv"}],["path",{d:"M12 4h0.01",key:"1e3d8f"}],["path",{d:"M17 4h0.01",key:"p7cxgy"}]]),q=["üéâ","üéÇ","ü•≥","üéà","üéÅ","üòä","ü•∞","üíñ","üç∞","üçæ","‚ú®","üåü","üéä","üòÉ","üòé","ü§©","üôå","üëè","üíê","üßÅ","üç¨","üç≠","üç¶","üç®","üçß","üç°","üç™","üç´","üç©","üçÆ","üçØ","üçµ","‚òï","üßÉ","ü•§","üçπ","üç∏","üç∑","ü•Ç","üçª","üç∫","ü•É","üßâ","üßä","üçæ","ü•Ñ","üçΩÔ∏è","ü•¢","üç¥","ü•Ñ","üçΩÔ∏è","ü•¢","üç¥"],I=Array.from(new Set(q)),L=({onSelect:g})=>e.jsx("div",{className:"flex flex-wrap gap-2 p-2 bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 max-w-xs",children:I.map((i,t)=>e.jsx("button",{type:"button",className:"text-2xl hover:scale-125 transition-transform focus:outline-none",onClick:()=>g(i),children:i},i+"-"+t))}),F=({onSuccess:g,onCancel:i,initialData:t})=>{const[u,y]=o.useState(""),[r,f]=o.useState(null),[p,k]=o.useState(""),[n,x]=o.useState(""),[d,N]=o.useState(null),[h,j]=o.useState(!1),[C,w]=o.useState(!1);z.useEffect(()=>{t&&(y(t.nombre||""),f(t.usuario||null),k(t.fecha_nacimiento||""),x(t.mensaje||""))},[t]);const _=a=>{a.target.files&&a.target.files[0]&&N(a.target.files[0])},S=async a=>{a.preventDefault(),j(!0);let b="";try{if(d){const l=`cumpleanos/${Date.now()}_${d.name}`,{error:s}=await m.storage.from("cumpleanos-media").upload(l,d,{upsert:!0});if(s)throw s;const{data:M}=m.storage.from("cumpleanos-media").getPublicUrl(l);b=M.publicUrl}let c;if(t&&t.id){const{data:l,error:s}=await m.from("cumpleanos").update({nombre:u,usuario_id:(r==null?void 0:r.id)||null,fecha_nacimiento:p,mensaje:n,imagen_url:b||t.imagen_url}).eq("id",t.id).select().single();if(s)throw s;c=l}else{const{data:l,error:s}=await m.from("cumpleanos").insert({nombre:u,usuario_id:(r==null?void 0:r.id)||null,fecha_nacimiento:p,mensaje:n,imagen_url:b}).select().single();if(s)throw s;c=l,await m.from("eventos").insert({titulo:`Cumplea√±os de ${u}`,descripcion:n,tipo:"birthday",fecha_inicio:p,creador_id:(r==null?void 0:r.id)||null,imagen_url:b||null})}v.success(t&&t.id?"Cumplea√±os actualizado":"Cumplea√±os creado exitosamente"),g(c)}catch(c){v.error("Error al crear/actualizar cumplea√±os: "+c.message)}finally{j(!1)}};return e.jsxs("form",{onSubmit:S,className:"space-y-8 bg-white dark:bg-gray-900 p-8 rounded-2xl shadow-xl max-w-lg mx-auto border border-gray-100 dark:border-gray-800",children:[e.jsx("h2",{className:"text-2xl font-bold text-center text-primary-700 dark:text-primary-300 mb-6 flex items-center justify-center gap-2",children:"üéâ Crear Cumplea√±os"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-200",children:"Imagen"}),e.jsxs("div",{className:"relative w-28 h-28 mb-2",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:_,className:"absolute inset-0 opacity-0 cursor-pointer z-10 w-full h-full"}),e.jsx("div",{className:"w-28 h-28 rounded-full border-4 border-primary-300 dark:border-primary-700 bg-gray-100 dark:bg-gray-800 flex items-center justify-center overflow-hidden shadow",children:d?e.jsx("img",{src:URL.createObjectURL(d),alt:"preview",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-gray-400 text-4xl",children:"+"})})]}),e.jsx("span",{className:"text-xs text-gray-400",children:"Haz clic para subir una imagen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-200",children:"Nombre de usuario"}),e.jsx("input",{type:"text",className:"input w-full rounded-lg border-2 border-primary-200 dark:border-primary-700 focus:ring-2 focus:ring-primary-400 focus:border-primary-400 dark:bg-gray-800 dark:text-white transition",value:(r==null?void 0:r.nombre_usuario)||"",onChange:a=>f(r?{...r,nombre_usuario:a.target.value}:{id:"",nombre_completo:"",nombre_usuario:a.target.value}),placeholder:"usuario123",required:!0}),(r==null?void 0:r.nombre_usuario)&&e.jsxs("a",{href:`/profile/${r.nombre_usuario}`,className:"block mt-1 text-primary-600 dark:text-primary-400 hover:underline text-sm",target:"_blank",rel:"noopener noreferrer",children:["Ver perfil de @",r.nombre_usuario]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-200",children:"Nombre"}),e.jsx("input",{type:"text",className:"input w-full rounded-lg border-2 border-primary-200 dark:border-primary-700 focus:ring-2 focus:ring-primary-400 focus:border-primary-400 dark:bg-gray-800 dark:text-white transition",value:u,onChange:a=>y(a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-200",children:"Fecha de nacimiento"}),e.jsx("input",{type:"date",className:"input w-full rounded-lg border-2 border-primary-200 dark:border-primary-700 focus:ring-2 focus:ring-primary-400 focus:border-primary-400 dark:bg-gray-800 dark:text-white transition",value:p,onChange:a=>k(a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-200",children:"Mensaje de felicitaci√≥n"}),e.jsxs("div",{className:"relative bg-primary-50 dark:bg-primary-900/30 rounded-xl p-3 border border-primary-100 dark:border-primary-800 flex flex-col gap-2",children:[e.jsx("textarea",{className:"input w-full rounded-lg border-2 border-primary-200 dark:border-primary-700 focus:ring-2 focus:ring-primary-400 focus:border-primary-400 dark:bg-gray-800 dark:text-white transition resize-none min-h-[80px]",value:n,onChange:a=>x(a.target.value),rows:3,placeholder:"¬°Feliz cumplea√±os! Que tengas un d√≠a incre√≠ble.",required:!0}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{type:"button",className:"bg-primary-100 dark:bg-primary-800 text-primary-600 dark:text-primary-300 rounded-full p-2 shadow hover:bg-primary-200 dark:hover:bg-primary-700 transition",onClick:()=>w(a=>!a),"aria-label":"Insertar emoji",children:e.jsx("span",{role:"img","aria-label":"emoji",children:"üòä"})}),e.jsxs("label",{className:"bg-primary-100 dark:bg-primary-800 text-primary-600 dark:text-primary-300 rounded-full p-2 shadow hover:bg-primary-200 dark:hover:bg-primary-700 transition cursor-pointer flex items-center","aria-label":"Adjuntar archivo",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l7.07-7.07a4 4 0 00-5.656-5.657l-7.07 7.07a6 6 0 108.485 8.485l6.364-6.364"})}),e.jsx("input",{type:"file",className:"hidden",onChange:()=>{}})]})]}),C&&e.jsx("div",{className:"absolute right-0 top-14 z-20",children:e.jsx(L,{onSelect:a=>{x(n+a),w(!1)}})})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end mt-6",children:[e.jsx("button",{type:"button",className:"btn btn-ghost px-6 py-2 rounded-full",onClick:i,disabled:h,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary px-6 py-2 rounded-full shadow-lg",disabled:h,children:h?"Creando...":"Crear cumplea√±os"})]})]})};export{F as C,U as a};
