import{u as z,r,j as e,s as j,a as u,b as H,P as U,m as F}from"./index-B6IxMaGL.js";import{C as M,F as P}from"./CreatePostForm-8VnOEPKH.js";import{C as _}from"./CreateEventForm-4VxK9CHV.js";import{C as $}from"./calendar-C4cmb3Pa.js";import{C as O}from"./cake-DdBCSJR3.js";import"./postStore-Ll14iVld.js";import"./en-US-EYaBdrUG.js";import"./video-Cufy5hVZ.js";const q=({onSuccess:t})=>{const{user:s}=z(),[i,n]=r.useState(""),[c,d]=r.useState(""),[m,v]=r.useState(""),[B,h]=r.useState(""),[w,E]=r.useState("General"),[l,N]=r.useState(!1),[b,g]=r.useState(0),[y,p]=r.useState(null),I=async a=>{var S;const o=(S=a.target.files)==null?void 0:S[0];if(!o)return;p(URL.createObjectURL(o)),g(0);const C=setInterval(()=>{g(f=>f>=90?(clearInterval(C),f):f+10)},100),D=o.name.split(".").pop(),k=`blog-covers/${Date.now()}_${Math.random().toString(36).substring(2,8)}.${D}`,{error:L}=await j.storage.from("media").upload(k,o);if(clearInterval(C),g(100),L){u.error("Error al subir la imagen");return}const{data:T}=j.storage.from("media").getPublicUrl(k);h(T.publicUrl),u.success("Imagen subida correctamente")},R=async a=>{if(a.preventDefault(),!s){u.error("Debes iniciar sesión para publicar un blog");return}if(!i.trim()||!m.trim()){u.error("El título y el contenido son obligatorios");return}N(!0);try{const{error:o}=await j.from("publicaciones").insert({autor_id:s.id,titulo:i.trim(),contenido:m.trim(),excerpt:c.trim()||m.substring(0,120),imagen_portada:B,categoria:w,publicado_en:new Date().toISOString(),actualizado_en:new Date().toISOString(),tipo:"blog"});if(o)throw o;u.success("¡Blog publicado exitosamente!"),n(""),d(""),v(""),h(""),p(null),t&&t()}catch{u.error("Error al publicar el blog")}finally{N(!1)}};return e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Título *"}),e.jsx("input",{type:"text",value:i,onChange:a=>n(a.target.value),className:"input w-full",required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Resumen"}),e.jsx("textarea",{value:c,onChange:a=>d(a.target.value),className:"input w-full",rows:2,maxLength:120,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Contenido *"}),e.jsx("textarea",{value:m,onChange:a=>v(a.target.value),className:"input w-full",rows:6,required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Imagen de portada"}),e.jsx("input",{type:"file",accept:"image/*",onChange:I,disabled:l}),y&&e.jsxs("div",{className:"mt-2 relative rounded-lg overflow-hidden",children:[e.jsx("img",{src:y,alt:"Previsualización",className:"w-full max-h-48 object-cover rounded-lg"}),b>0&&b<100&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-2 bg-primary-100",children:e.jsx("div",{className:"h-2 bg-primary-600",style:{width:`${b}%`}})}),e.jsx("button",{type:"button",onClick:()=>{p(null),h("")},className:"absolute top-2 right-2 bg-gray-900/70 text-white p-1 rounded-full",children:"✕"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium",children:"Categoría"}),e.jsxs("select",{value:w,onChange:a=>E(a.target.value),className:"input w-full",disabled:l,children:[e.jsx("option",{value:"General",children:"General"}),e.jsx("option",{value:"Arte",children:"Arte"}),e.jsx("option",{value:"Música",children:"Música"}),e.jsx("option",{value:"Cine",children:"Cine"}),e.jsx("option",{value:"Danza",children:"Danza"}),e.jsx("option",{value:"Literatura",children:"Literatura"})]})]}),e.jsxs("button",{type:"submit",disabled:l,className:"btn btn-primary flex items-center","aria-busy":l,children:[l?e.jsx("span",{className:"loader mr-2"}):null,l?"Publicando...":"Publicar blog"]})]})},x=({icon:t,label:s,color:i,onClick:n})=>e.jsxs(F.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,className:`flex flex-col items-center justify-center p-6 rounded-xl ${i} w-full h-full`,children:[t,e.jsx("span",{className:"mt-2 text-sm font-medium",children:s})]}),Y=()=>{const[t,s]=r.useState(null),i=H(),n=m=>{s(m)},c=()=>{s(null)},d=()=>{i(t==="post"?"/":"/calendar")};return t==="post"?e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("button",{onClick:c,className:"text-sm font-medium text-primary-600 dark:text-primary-400 flex items-center mr-auto",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back"]}),e.jsx("h2",{className:"text-lg font-semibold text-center text-gray-900 dark:text-white",children:"Create Post"}),e.jsx("div",{className:"mr-auto"})," "]}),e.jsx(M,{onSuccess:d})]}):t==="event"||t==="birthday"||t==="task"?e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("button",{onClick:c,className:"text-sm font-medium text-primary-600 dark:text-primary-400 flex items-center mr-auto",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back"]}),e.jsxs("h2",{className:"text-lg font-semibold text-center text-gray-900 dark:text-white",children:["Create ",t==="event"?"Event":t==="birthday"?"Birthday":"Task"]}),e.jsx("div",{className:"mr-auto"})," "]}),e.jsx(_,{date:new Date,onSuccess:d,onCancel:c})]}):t==="blog"?e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("button",{onClick:c,className:"text-sm font-medium text-primary-600 dark:text-primary-400 flex items-center mr-auto",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver"]}),e.jsx("h2",{className:"text-lg font-semibold text-center text-gray-900 dark:text-white",children:"Publicar Blog"}),e.jsx("div",{className:"mr-auto"})]}),e.jsx(q,{onSuccess:d})]}):e.jsxs("div",{className:"py-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-6 text-center text-gray-900 dark:text-white",children:"Create New"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{icon:e.jsx(U,{className:"h-8 w-8 text-white"}),label:"Post",color:"bg-gradient-to-br from-primary-600 to-primary-700 text-white",onClick:()=>s("post")}),e.jsx(x,{icon:e.jsx($,{className:"h-8 w-8 text-white"}),label:"Event",color:"bg-gradient-to-br from-secondary-600 to-secondary-700 text-white",onClick:()=>n("event")}),e.jsx(x,{icon:e.jsx(O,{className:"h-8 w-8 text-white"}),label:"Birthday",color:"bg-gradient-to-br from-accent-600 to-accent-700 text-white",onClick:()=>n("birthday")}),e.jsx(x,{icon:e.jsx(P,{className:"h-8 w-8 text-white"}),label:"Task",color:"bg-gradient-to-br from-yellow-600 to-yellow-700 text-white",onClick:()=>n("task")}),e.jsx(x,{icon:e.jsx(P,{className:"h-8 w-8"}),label:"Blog",color:"bg-primary-50 dark:bg-primary-900/20",onClick:()=>s("blog")})]})]})};export{Y as default};
