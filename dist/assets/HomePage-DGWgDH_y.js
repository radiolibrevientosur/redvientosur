import{j as e,r}from"./index-BSYyVXs5.js";import{C as F}from"./CreatePostForm-Cm2_bUsk.js";import{P as I}from"./PostCard-BFO66cSj.js";import{u as M}from"./postStore-CoxJlB11.js";import{u as z}from"./eventStore-TM1Hv5vt.js";import{E as H}from"./EventoCulturalCard-Bv--oRdI.js";import{C as O}from"./CreateEventForm-dfDmf1pC.js";import"./native-DW4p8yi9.js";import"./send-Ch9fY7Oq.js";import"./more-horizontal-CXuOmTNl.js";import"./share-2-CEWE7vn2.js";import"./endOfMonth-CHJGNAHY.js";import"./en-US-D3c9jfE3.js";import"./format-6SnhDrvL.js";import"./es-B8gmi2Zg.js";const C=({type:i="post"})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]})]}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-3"}),i==="event"&&e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),e.jsxs("div",{className:"flex space-x-4 mt-2",children:[e.jsx("div",{className:"h-5 w-12 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-5 w-12 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),R=[{label:"Para ti",value:"feed"},{label:"Lo último",value:"timeline"}],se=()=>{var y,h,b,f,j,v,N,k,w,E;const{posts:i,isLoading:P,fetchPosts:u}=M(),{events:n,isLoading:D,fetchEvents:o}=z(),[a,l]=r.useState(null),[c,L]=r.useState("feed"),[T]=r.useState("feed"),[m,p]=r.useState(i),[g,x]=r.useState(n);return r.useEffect(()=>{p(i)},[i]),r.useEffect(()=>{x(n)},[n]),r.useEffect(()=>{u(),o()},[u,o]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{onSuccess:()=>{setTimeout(()=>{const t=document.querySelector(".feed-item");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},100)}}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-lg relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",onClick:()=>l(null),children:"✕"}),e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Editar evento"}),e.jsx(O,{date:new Date(a.date),onSuccess:()=>{l(null),o()},onCancel:()=>l(null),initialData:{id:a.id,title:a.title,description:a.description,event_type:a.type,date:a.date.split("T")[0],location:a.location,target_audience:["Infantil","Adultos","Todos"].includes(((y=a.metadata)==null?void 0:y.target_audience)??"")?(h=a.metadata)==null?void 0:h.target_audience:void 0,cost:{type:"free"},responsible_person:((b=a.metadata)==null?void 0:b.responsible_person)||{name:"",phone:""},technical_requirements:((f=a.metadata)==null?void 0:f.technical_requirements)||[],image_url:a.imagen_url,tags:((j=a.metadata)==null?void 0:j.tags)||[],recurrence:(v=a.metadata)!=null&&v.recurrence&&typeof((N=a.metadata)==null?void 0:N.recurrence.type)=="string"&&["custom","none","daily","weekly","monthly"].includes((k=a.metadata)==null?void 0:k.recurrence.type)?{...(w=a.metadata)==null?void 0:w.recurrence,type:(E=a.metadata)==null?void 0:E.recurrence.type}:{type:"none"}}})]})}),e.jsx("div",{className:"flex justify-center gap-4 my-4",children:R.map(t=>e.jsx("button",{className:`px-4 py-2 rounded-full font-semibold transition-colors duration-150 ${c===t.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,onClick:()=>L(t.value),"aria-pressed":c===t.value,children:t.label},t.value))}),e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mt-4",children:"Eventos culturales"}),D?e.jsx("div",{children:[...Array(2)].map((t,s)=>e.jsx(C,{type:"event"},s))}):g.length===0?e.jsxs("div",{className:"card py-8 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg font-semibold mb-2",children:"No hay eventos culturales aún"}),e.jsx("p",{className:"text-sm text-gray-400",children:"¡Sé el primero en crear un evento!"})]}):e.jsx("div",{className:"space-y-4",children:(T==="feed"?g.slice():g.slice().sort((t,s)=>new Date(s.date).getTime()-new Date(t.date).getTime())).map(t=>{var s,d,_,S;return e.jsx(H,{event:{id:t.id,titulo:t.title,descripcion:t.description,fecha_inicio:t.date,ubicacion:t.location||"",imagen_url:t.imagen_url,categoria:"",tipo:t.type,userId:t.userId,metadata:{target_audience:((s=t.metadata)==null?void 0:s.target_audience)||"",responsible_person:((d=t.metadata)==null?void 0:d.responsible_person)||{name:"",phone:""},technical_requirements:((_=t.metadata)==null?void 0:_.technical_requirements)||[],tags:((S=t.metadata)==null?void 0:S.tags)||[]}},onEdit:()=>l(t),onDeleted:()=>{x(q=>q.filter(A=>A.id!==t.id))}},t.id)})}),e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mt-8",children:"Publicaciones"}),P?e.jsx("div",{children:[...Array(3)].map((t,s)=>e.jsx(C,{type:"post"},s))}):m.length===0?e.jsxs("div",{className:"card py-8 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg font-semibold mb-2",children:"No hay publicaciones aún"}),e.jsx("p",{className:"text-sm text-gray-400",children:"¡Crea tu primera publicación para comenzar!"})]}):e.jsx("div",{className:"space-y-4",children:(c==="feed"?m.slice().sort((t,s)=>s.likes.length-t.likes.length):m.slice().sort((t,s)=>new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime())).map(t=>e.jsx(I,{post:t,onDeleted:()=>{p(s=>s.filter(d=>d.id!==t.id))}},t.id))})]})};export{se as default};
