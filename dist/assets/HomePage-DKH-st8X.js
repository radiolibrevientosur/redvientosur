import{j as t,r as n}from"./index-BrRfBUNT.js";import{C as D}from"./CreatePostForm-DRK_Vtoq.js";import{P as T}from"./PostCard-1hAzN2k_.js";import{u as q}from"./postStore-CI7NDm86.js";import{u as A}from"./eventStore-CHnCJt4g.js";import{E as L}from"./EventoCulturalCard-DpdPM89x.js";import{C as F}from"./CreateEventForm-C_Ywb-U_.js";import"./native-Cgrkzqac.js";import"./send-C65sD64D.js";import"./share-2-2ppTR6CC.js";import"./endOfMonth-CHJGNAHY.js";import"./en-US-D3c9jfE3.js";import"./format-6SnhDrvL.js";import"./es-B8gmi2Zg.js";const _=({type:r="post"})=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-4 animate-pulse",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-full"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mb-2"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/4"})]})]}),t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-3"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2 mb-3"}),r==="event"&&t.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded mb-3"}),t.jsxs("div",{className:"flex space-x-4 mt-2",children:[t.jsx("div",{className:"h-5 w-12 bg-gray-200 dark:bg-gray-700 rounded"}),t.jsx("div",{className:"h-5 w-12 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),I=[{label:"Para ti",value:"feed"},{label:"Lo último",value:"timeline"}],X=()=>{var u,p,x,h,y,b,f,j,v,N;const{posts:r,isLoading:E,fetchPosts:m}=q(),{events:l,isLoading:C,fetchEvents:d}=A(),[a,i]=n.useState(null),[o,S]=n.useState("feed"),[P]=n.useState("feed");n.useEffect(()=>{m(),d()},[m,d]);const g=(e,s)=>{e==="post"?window.location.href=`/posts/${s}`:e==="event"&&(window.location.href=`/eventos/${s}`)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx(D,{onSuccess:()=>{setTimeout(()=>{const e=document.querySelector(".feed-item");e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100)}}),a&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-lg relative",children:[t.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",onClick:()=>i(null),children:"✕"}),t.jsx("h2",{className:"text-lg font-bold mb-4",children:"Editar evento"}),t.jsx(F,{date:new Date(a.date),onSuccess:()=>{i(null),d()},onCancel:()=>i(null),initialData:{id:a.id,title:a.title,description:a.description,event_type:a.type,date:a.date.split("T")[0],location:a.location,target_audience:["Infantil","Adultos","Todos"].includes(((u=a.metadata)==null?void 0:u.target_audience)??"")?(p=a.metadata)==null?void 0:p.target_audience:void 0,cost:{type:"free"},responsible_person:((x=a.metadata)==null?void 0:x.responsible_person)||{name:"",phone:""},technical_requirements:((h=a.metadata)==null?void 0:h.technical_requirements)||[],image_url:a.imagen_url,tags:((y=a.metadata)==null?void 0:y.tags)||[],recurrence:(b=a.metadata)!=null&&b.recurrence&&typeof((f=a.metadata)==null?void 0:f.recurrence.type)=="string"&&["custom","none","daily","weekly","monthly"].includes((j=a.metadata)==null?void 0:j.recurrence.type)?{...(v=a.metadata)==null?void 0:v.recurrence,type:(N=a.metadata)==null?void 0:N.recurrence.type}:{type:"none"}}})]})}),t.jsx("div",{className:"flex justify-center gap-4 my-4",children:I.map(e=>t.jsx("button",{className:`px-4 py-2 rounded-full font-semibold transition-colors duration-150 ${o===e.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200"}`,onClick:()=>S(e.value),"aria-pressed":o===e.value,children:e.label},e.value))}),t.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mt-4",children:"Eventos culturales"}),C?t.jsx("div",{children:[...Array(2)].map((e,s)=>t.jsx(_,{type:"event"},s))}):l.length===0?t.jsxs("div",{className:"card py-8 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg font-semibold mb-2",children:"No hay eventos culturales aún"}),t.jsx("p",{className:"text-sm text-gray-400",children:"¡Sé el primero en crear un evento!"})]}):t.jsx("div",{className:"space-y-4",children:(P==="feed"?l.slice():l.slice().sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime())).map(e=>{var s,c,k,w;return t.jsx("div",{className:"cursor-pointer",onClick:()=>g("event",e.id),children:t.jsx(L,{event:{id:e.id,titulo:e.title,descripcion:e.description,fecha_inicio:e.date,ubicacion:e.location||"",imagen_url:e.imagen_url,categoria:"",tipo:e.type,userId:e.userId,metadata:{target_audience:((s=e.metadata)==null?void 0:s.target_audience)||"",responsible_person:((c=e.metadata)==null?void 0:c.responsible_person)||{name:"",phone:""},technical_requirements:((k=e.metadata)==null?void 0:k.technical_requirements)||[],tags:((w=e.metadata)==null?void 0:w.tags)||[]}},onEdit:()=>i(e)})},e.id)})}),t.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mt-8",children:"Publicaciones"}),E?t.jsx("div",{children:[...Array(3)].map((e,s)=>t.jsx(_,{type:"post"},s))}):r.length===0?t.jsxs("div",{className:"card py-8 text-center",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-lg font-semibold mb-2",children:"No hay publicaciones aún"}),t.jsx("p",{className:"text-sm text-gray-400",children:"¡Crea tu primera publicación para comenzar!"})]}):t.jsx("div",{className:"space-y-4",children:(o==="feed"?r.slice().sort((e,s)=>s.likes.length-e.likes.length):r.slice().sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime())).map(e=>t.jsx("div",{className:"cursor-pointer",onClick:s=>{s.target.closest("a")||g("post",e.id)},children:t.jsx(T,{post:e})},e.id))})]})};export{X as default};
