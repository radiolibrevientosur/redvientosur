import{c as d,r as h,u as C,j as e,s as S,a as g}from"./index-B6IxMaGL.js";import{u as P,g as y,f as u}from"./postStore-Ll14iVld.js";import{H as I}from"./heart-BdB3Phk6.js";import{M}from"./message-circle-DKEekrRi.js";import{S as E}from"./share-2-_ELcaaEb.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=d("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=d("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=d("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),F=({post:a})=>{const[l,m]=h.useState(!1),[c,n]=h.useState(""),{user:r}=C(),{toggleLike:p,addComment:j,toggleFavorite:f,removePost:x}=P(),t=y(a.userId),o=r?a.likes.includes(r.id):!1,v=()=>{r&&p(a.id,r.id)},N=s=>{s.preventDefault(),r&&c.trim()&&(j(a.id,r.id,c),n(""))},k=()=>{f(a.id)},b=()=>{alert("Sharing functionality would be implemented here")},w=async()=>{if(!(!r||r.id!==a.userId)&&window.confirm("¿Estás seguro de eliminar este post?"))try{const{error:s}=await S.from("publicaciones").delete().eq("id",a.id);if(s)throw s;g.success("Post eliminado exitosamente"),x&&x(a.id)}catch{g.error("Error al eliminar el post")}};return e.jsxs("article",{className:"feed-item",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:t==null?void 0:t.avatar,alt:t==null?void 0:t.displayName,className:"avatar-img"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t==null?void 0:t.displayName}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:u(a.createdAt)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:e.jsx(T,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})}),r&&r.id===a.userId&&e.jsx("button",{onClick:w,className:"p-2 rounded-full hover:bg-red-100 dark:hover:bg-red-900",children:e.jsx(z,{className:"h-5 w-5 text-red-500"})})]})]}),e.jsx("div",{className:"px-4 pb-3",children:e.jsx("p",{className:"mb-3 text-gray-900 dark:text-white",children:a.content})}),a.mediaUrl&&e.jsx("div",{className:"relative pb-3",children:e.jsx("img",{src:a.mediaUrl,alt:"Post media",className:"w-full object-cover max-h-[500px]"})}),e.jsxs("div",{className:"px-4 py-2 flex items-center justify-between border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("button",{onClick:v,className:"flex items-center space-x-1 group",children:[e.jsx(I,{className:`h-5 w-5 ${o?"text-red-500 fill-red-500":"text-gray-600 dark:text-gray-400 group-hover:text-red-500"}`}),e.jsx("span",{className:`text-sm ${o?"text-red-500":"text-gray-600 dark:text-gray-400 group-hover:text-red-500"}`,children:a.likes.length})]}),e.jsxs("button",{onClick:()=>m(!l),className:"flex items-center space-x-1 group",children:[e.jsx(M,{className:"h-5 w-5 text-gray-600 dark:text-gray-400 group-hover:text-primary-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 group-hover:text-primary-500",children:a.comments.length})]}),e.jsx("button",{onClick:b,className:"flex items-center group",children:e.jsx(E,{className:"h-5 w-5 text-gray-600 dark:text-gray-400 group-hover:text-primary-500"})})]}),e.jsx("button",{onClick:k,className:"flex items-center group",children:e.jsx(H,{className:`h-5 w-5 ${a.isFavorite?"text-primary-500 fill-primary-500":"text-gray-600 dark:text-gray-400 group-hover:text-primary-500"}`})})]}),(a.comments.length>0||l)&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800/50 rounded-b-xl",children:[a.comments.length>0&&e.jsxs("div",{className:"mb-3 space-y-3",children:[a.comments.slice(0,l?void 0:2).map(s=>{const i=y(s.userId);return e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"avatar w-8 h-8",children:e.jsx("img",{src:i==null?void 0:i.avatar,alt:i==null?void 0:i.displayName,className:"avatar-img"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-900 p-2 rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white",children:i==null?void 0:i.displayName}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:s.content})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:u(s.createdAt)})]})]},s.id)}),a.comments.length>2&&!l&&e.jsxs("button",{onClick:()=>m(!0),className:"text-sm text-primary-600 dark:text-primary-400 font-medium",children:["View all ",a.comments.length," comments"]})]}),r&&e.jsxs("form",{onSubmit:N,className:"flex items-center space-x-2",children:[e.jsx("div",{className:"avatar w-8 h-8",children:e.jsx("img",{src:r.avatar,alt:r.displayName,className:"avatar-img"})}),e.jsx("input",{type:"text",placeholder:"Add a comment...",className:"flex-1 bg-white dark:bg-gray-900 rounded-full px-4 py-2 text-sm border border-gray-200 dark:border-gray-700 focus:ring-1 focus:ring-primary-500 focus:border-primary-500",value:c,onChange:s=>n(s.target.value)}),e.jsx("button",{type:"submit",disabled:!c.trim(),className:"text-sm font-medium text-primary-600 dark:text-primary-400 disabled:opacity-50",children:"Post"})]})]})]})};export{H as B,F as P,z as T};
