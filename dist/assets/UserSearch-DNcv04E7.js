import{r as s,s as b,j as t,S as y}from"./index-COvD-dsj.js";const v=()=>{const[n,h]=s.useState(""),[a,u]=s.useState([]),[f,g]=s.useState(!1),[l,o]=s.useState(!1),[d,i]=s.useState(0),c=s.useRef(null),m=s.useRef(null);s.useEffect(()=>{if(!n.trim()){u([]),o(!1);return}g(!0);const e=setTimeout(async()=>{const{data:r,error:x}=await b.from("usuarios").select("id, nombre_usuario, nombre_completo, avatar_url").or(`nombre_usuario.ilike.%${n}%,nombre_completo.ilike.%${n}%`).limit(8);!x&&r?(u(r),o(!0)):(u([]),o(!1)),g(!1)},250);return()=>clearTimeout(e)},[n]),s.useEffect(()=>{function e(r){m.current&&!m.current.contains(r.target)&&c.current&&!c.current.contains(r.target)&&o(!1)}return l&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[l]);const p=e=>{!l||a.length===0||(e.key==="ArrowDown"?(i(r=>(r+1)%a.length),e.preventDefault()):e.key==="ArrowUp"?(i(r=>(r-1+a.length)%a.length),e.preventDefault()):e.key==="Enter"?a[d]&&(window.location.href=`/profile/${a[d].nombre_usuario}`,o(!1)):e.key==="Escape"&&o(!1))};return t.jsxs("div",{className:"relative max-w-md mx-auto w-full",style:{padding:8},children:[t.jsxs("div",{className:"flex items-center bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-full px-3 py-2 shadow-sm focus-within:ring-2 focus-within:ring-primary-500",children:[t.jsx(y,{className:"h-5 w-5 text-gray-400 mr-2"}),t.jsx("input",{ref:c,type:"text",className:"flex-1 bg-transparent outline-none text-sm",placeholder:"Buscar usuarios por nombre o usuario...",value:n,onChange:e=>{h(e.target.value),i(0)},onFocus:()=>{a.length>0&&o(!0)},onKeyDown:p,autoComplete:"off",spellCheck:!1}),f&&t.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"Buscando..."})]}),l&&a.length>0&&t.jsx("div",{ref:m,className:"absolute left-0 right-0 mt-2 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto animate-fade-in",children:a.map((e,r)=>t.jsxs("div",{className:`flex items-center px-4 py-2 cursor-pointer hover:bg-primary-50 dark:hover:bg-gray-800 ${d===r?"bg-primary-100 dark:bg-gray-800":""}`,onMouseDown:()=>{window.location.href=`/profile/${e.nombre_usuario}`,o(!1)},onMouseEnter:()=>i(r),children:[t.jsx("img",{src:e.avatar_url||"/default-avatar.png",alt:e.nombre_completo||e.nombre_usuario,className:"w-8 h-8 rounded-full mr-3"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"font-medium text-sm",children:e.nombre_completo||e.nombre_usuario}),t.jsxs("span",{className:"text-xs text-gray-500",children:["@",e.nombre_usuario]})]})]},e.id))}),l&&!f&&a.length===0&&t.jsx("div",{className:"absolute left-0 right-0 mt-2 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 p-4 text-center text-gray-500 animate-fade-in",children:"No se encontraron usuarios."})]})};export{v as UserSearch,v as default};
